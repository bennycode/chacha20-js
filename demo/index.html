<!DOCTYPE html>
<html>
  <head>
    <title>chacha20-js</title>
    <meta charset="UTF-8" />
    <script src="../src/ChaCha20.js"></script>
  </head>
  <body>
    <script>
      (function () {
        function fromHex(hex_input) {
          hex_input.replace(' ', '');
          var out = [], len = hex_input.length, w = '';
          for (var i = 0; i < len; i += 2) {
            w = hex_input[i];
            if (((i + 1) >= len) || typeof hex_input[i + 1] === 'undefined') {
              w += '0';
            } else {
              w += hex_input[i + 1];
            }
            out.push(parseInt(w, 16));
          }
          return out;
        }

        var key = fromHex('000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f');
        var keyStream = fromHex(
                'f798a189f195e66982105ffb640bb7757f579da31602fc93ec01ac56' +
                'f85ac3c134a4547b733b46413042c9440049176905d3be59ea1c53f1' +
                '5916155c2be8241a38008b9a26bc35941e2444177c8ade6689de9526' +
                '4986d95889fb60e84629c9bd9a5acb1cc118be563eb9b3a4a472f82e' +
                '09a7e778492b562ef7130e88dfe031c79db9d4f7c7a899151b9a4750' +
                '32b63fc385245fe054e3dd5a97a5f576fe064025d3ce042c566ab2c5' +
                '07b138db853e3d6959660996546cc9c4a6eafdc777c040d70eaf46f7' +
                '6dad3979e5c5360c3317166a1c894c94a371876a94df7628fe4eaaf2' +
                'ccb27d5aaae0ad7ad0f9d4b6ad3b54098746d4524d38407a6deb3ab7' +
                '8fab78c9'
                );
        var nonce = fromHex('0001020304050607');

        var context = new ChaCha20(key, nonce);
        var out = new Array(key.length);
        context.generateKeyStream(out, out);

        console.log('Keystream (Source)', keyStream);
        console.log('Keystream (Generated)', out);
      })();
    </script>
  </body>
</html>
